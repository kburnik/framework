<?phpinclude_once( dirname(__FILE__) . "/.testsuite.include.php");class DummyApiInterface extends ApiInterface{  public function login( $username , $password )  {    $this->standIn();  }}class DummyRemoteXhrResponder {  public $callStack = array();  public $api;  public function __construct( )  {    $this->api = new RemoteXhrApiDelegate(      new DummyApiInterface( "http://example.com" ) , array($this,'sendRequest')    );  }  public function sendRequest( $method, $params )  {    $this->callStack[] = array($method,$params);  }}class RemoteXhrApiDelegateTestCase extends TestCase{  private $responder;  public function __construct( )  {    $this->responder = new DummyRemoteXhrResponder();  }  public function testCallMethodViaReflection()  {    $this->responder->api->login( "usr" , "pwd" );    $expected = array(      "login", array(        "username" => "usr",        "password" => "pwd"      )    );    $actual = array_pop( $this->responder->callStack );    $this->assertEqual( $expected , $actual );  }}
